window.Features=new function(){var _app=angular.module("starter"),$this={},__features={};return $this.featuresToLoadOnStart=[],$this.insertCSS=function(css_content,feature_code){var css=document.createElement("style");css.type="text/css",css.setAttribute("data-feature",feature_code),css.innerHTML=css_content,document.head.appendChild(css)},$this.isRegistered=function(code){return __features.hasOwnProperty(code)},$this.register=function(json,bundle){if(angular.isDefined(json.load_on_start)&&json.load_on_start){var onStart={path:bundle};json.on_start_factory&&(onStart.factory=json.on_start_factory),$this.featuresToLoadOnStart.push(onStart)}var lazyLoadBundle=angular.copy(bundle);json.lazyLoad&&json.lazyLoad.module&&(lazyLoadBundle=lazyLoadBundle.concat(json.lazyLoad.module));var feature_base="features/"+json.code+"/";_app.config(["$stateProvider","HomepageLayoutProvider",function($stateProvider,HomepageLayoutProvider){var template_base=feature_base+"assets/templates/",routes={};angular.forEach(json.routes,function(r){if(!1!==r.autoregister){var route={url:BASE_PATH+"/"+r.url,controller:r.controller};switch(angular.isDefined(lazyLoadBundle)&&(route.resolve={lazy:["$ocLazyLoad",function($ocLazyLoad){return json.lazyLoad&&json.lazyLoad.core&&json.lazyLoad.core.forEach(function(bundle){$ocLazyLoad.load("./dist/packed/"+bundle+".bundle.min.js")}),$ocLazyLoad.load(lazyLoadBundle)}]}),!0){case angular.isString(r.templateHTML):route.template=r.templateHTML;break;case angular.isObject(r.layouts)&&angular.isString(r.template):route.templateUrl=function(param){if(void 0!==param.layout_id&&angular.isString(r.layouts[param.layout_id]))return template_base+r.layouts[param.layout_id]+"/"+r.template;var layout_id=HomepageLayoutProvider.getLayoutIdForValueId(param.value_id);return angular.isString(r.layouts[layout_id])?template_base+r.layouts[layout_id]+"/"+r.template:template_base+r.layouts.default+"/"+r.template};break;case!0===r.externalTemplate&&angular.isString(r.template):route.templateUrl=r.template;break;case angular.isString(r.template):route.templateUrl=template_base+r.template}route.cache=!1!==r.cache,this[r.state]=route}},routes),angular.forEach(routes,function(route,state){$stateProvider.state(state,route)})}]),__features[json.code]=json},_app.config(["$stateProvider",function($stateProvider){$stateProvider.state("go-to-feature",{url:BASE_PATH+"/goto/feature/:code/value_id/:value_id",template:"redirecting..."})}]).factory("Features",["$q","$state",function($q,$state){var factory={register:function(){throw new Error("You cannot register new features at runtime, please use window.Features before angular app has bootstraped.")},get:function(feature_code){return __features.hasOwnProperty(feature_code)?__features[feature_code]:null},goTo:function(feature_code,value_id){var feature=factory.get(feature_code);if(feature){for(var route=null,i=0;i<feature.routes.length;i++){var r=feature.routes[i];if(angular.isObject(r)&&r.root){route=feature.routes[i];break}}route&&($state.go(route.state,{value_id:value_id}),$q.resolve())}return $q.reject}};return factory}]).run(["$rootScope","Features",function($rootScope,Features){$rootScope.$on("$stateChangeStart",function(evt,toState,toParams,fromState,fromParams){angular.isObject(toState)&&"go-to-feature"===toState.name&&(evt.preventDefault(),angular.isObject(toParams)&&angular.isString(toParams.code)&&toParams.code.trim().length>0&&!isNaN(+toParams.value_id)&&+toParams.value_id>0&&Features.goTo(toParams.code,toParams.value_id))})}]),$this},window.hexToRgb=function(hex){var result=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);return result?{r:parseInt(result[1],16),g:parseInt(result[2],16),b:parseInt(result[3],16)}:null},window.rgbToHex=function(red,green,blue){return"#"+((1<<24)+(red<<16)+(green<<8)+blue).toString(16).slice(1)},window.textStyleFromHex=function(hex){var statusBarStyle="light",rgbColor=window.hexToRgb(hex);return.299*rgbColor.r+.587*rgbColor.g+.114*rgbColor.b>186&&(statusBarStyle="dark"),statusBarStyle},window.updateStatusBar=function(hex){switch(window.StatusBar.backgroundColorByHexString(hex),window.textStyleFromHex(hex)){case"dark":window.StatusBar.styleDefault();break;case"light":default:window.StatusBar.styleLightContent()}},angular.module("starter").config(["$provide",function($provide){var transformAsFormPost=function(data,getHeaders){return function serializeData(data,prefix){angular.isString(prefix)||(prefix=""),prefix=prefix.trim(),angular.isArray(data)&&prefix.length<1&&(prefix="data");var pairs=[];if(angular.isObject(data)||angular.isArray(data)){var index=0;angular.forEach(data,function(value,key){angular.isArray(data)&&(key=index),key=encodeURIComponent(key),prefix.length>0&&(key=prefix+"["+key+"]"),angular.isArray(value)||angular.isObject(value)?pairs.push(serializeData(value,key)):((angular.isUndefined(value)||null===value)&&(value=""),pairs.push(key+"="+encodeURIComponent(value))),index+=1})}return pairs.join("&").replace(/%20/g,"+")}(data)};$provide.decorator("$http",["$delegate",function($delegate){return $delegate.postForm=function(url,data,config){return angular.isObject(config)||(config={}),angular.isObject(config.headers)||(config.headers={}),config.headers["Content-Type"]="application/x-www-form-urlencoded; charset=utf-8",angular.isArray(config.transformRequest)?config.transformRequest.push(transformAsFormPost):angular.isFunction(config.transformRequest)?config.transformRequest=[config.transformRequest,transformAsFormPost]:config.transformRequest=transformAsFormPost,$delegate.post(url,data,config)},$delegate}])}]);